function airfoil = AirfoilNACA644X(thickness)
%NACA 644XX airfoil family
%Juan Mendez juan.mendez@ulpgc.es

    airfoil = struct(   'name',0,'thickness',0,'alpha',0,'CL',0,'CD',0,'CM',0,...
                        'xu',0,'yu',0,'xl',0,'yl',0,'M00',0,'M10',0,'M20',0,'M02',0,'M11',0);

    airfoil.name = 'NACA 64-4XX';
    airfoil.thickness = thickness;
    
    thickness = thickness/100;
    DataThick = [0.12 0.15 0.18 0.21 0.25];
    
    [X12u,Y12u,X12l,Y12l,alpha12,CL12,CD12,CM12] = naca64412;
    [X15u,Y15u,X15l,Y15l,alpha15,CL15,CD15,CM15] = naca64415;
    [X18u,Y18u,X18l,Y18l,alpha18,CL18,CD18,CM18] = naca64418;
    [X21u,Y21u,X21l,Y21l,alpha21,CL21,CD21,CM21] = naca64421;
    [X25u,Y25u,X25l,Y25l,alpha25,CL25,CD25,CM25] = naca64425;
   
    airfoil.alpha = alpha12;
    Na = length(airfoil.alpha);
    DataCL = [CL12 CL15 CL18 CL21 CL25];
    DataCD = [CD12 CD15 CD18 CD21 CD25];
    DataCM = [CM12 CM15 CM18 CM21 CM25];
    
    CL = zeros(Na,1);
    CD = zeros(Na,1);
    CM = zeros(Na,1);
    for a=1:Na
        CL(a) = spline(DataThick,DataCL(a,:),thickness);
        CD(a) = spline(DataThick,DataCD(a,:),thickness);
        CM(a) = spline(DataThick,DataCM(a,:),thickness);
    end
    airfoil.CL = CL;
    airfoil.CD = CD;
    airfoil.CM = CM;
    
    Nu = length(X12u);
    Yu = zeros(Nu,5);
    Yu(:,1)=Y12u;
    Yu(:,2) = spline(X15u,Y15u,X12u);
    Yu(:,3) = spline(X18u,Y18u,X12u);
    Yu(:,4) = spline(X21u,Y21u,X12u);
    Yu(:,5) = spline(X25u,Y25u,X12u);
    
    airfoil.xu = X12u;
    airfoil.yu = zeros(Nu,1);
    for a=1:Nu
        airfoil.yu(a) = spline(DataThick,Yu(a,:),thickness);
    end
  
    Nl = length(X12l);
    Yl = zeros(Nl,5);
    Yl(:,1)=Y12l;
    Yl(:,2) = spline(X15l,Y15l,X12l);
    Yl(:,3) = spline(X18l,Y18l,X12l);
    Yl(:,4) = spline(X21l,Y21l,X12l);
    Yl(:,5) = spline(X25l,Y25l,X12l);
    
    airfoil.xl = X12l;
    airfoil.yl = zeros(Nl,1);
    for a=1:Nl
        airfoil.yl(a) = spline(DataThick,Yl(a,:),thickness);
    end
    
     du = diff(airfoil.yu)./diff(airfoil.xu);
    du = [du;du(end)];
    fu = sqrt(1.0+(du).^2);
    dl = diff(airfoil.yl)./diff(airfoil.xl);
    dl = [dl;dl(end)];
    fl = sqrt(1.0+(dl).^2);
    airfoil.M00 =   trapz(airfoil.xu,fu)+...
                    trapz(airfoil.xl,fl);
    airfoil.M10 =   trapz(airfoil.xu,airfoil.xu .* fu)+...
                    trapz(airfoil.xl,airfoil.xl .* fl);
    airfoil.M01 =   trapz(airfoil.xu,airfoil.yu .* fu)+...
                    trapz(airfoil.xl,airfoil.yl .* fl);
    airfoil.M20 =   trapz(airfoil.xu,(airfoil.xu).^2 .* fu)+...
                    trapz(airfoil.xl,(airfoil.xl).^2 .* fl);
    airfoil.M02 =   trapz(airfoil.xu,(airfoil.yu).^2 .* fu)+...
                    trapz(airfoil.xl,(airfoil.yl).^2 .* fl);
    airfoil.M11 =   trapz(airfoil.xu,airfoil.xu .*airfoil.yu .* fu)+...
                    trapz(airfoil.xl,airfoil.xl .*airfoil.yl .* fl);
    
 
end

function [xu,yu,xl,yl,alpha,CL,CD,CM] = naca64412

A= [
1.00000000	0.00000000
0.99269407	0.00154378
0.98058096	0.00376544
0.96380414	0.00676509
0.94253724	0.01058208
0.91698887	0.01520318
0.88740521	0.02058712
0.85406525	0.02665280
0.81727953	0.03328724
0.77738243	0.04031818
0.73473122	0.04752112
0.68970954	0.05465034
0.64272667	0.06144757
0.59421793	0.06766123
0.54463925	0.07302545
0.49446722	0.07727371
0.44419700	0.08012514
0.39434293	0.08120468
0.34544877	0.08028484
0.29804328	0.07779727
0.25261565	0.07405881
0.20963662	0.06919293
0.16954727	0.06336891
0.13276022	0.05675272
0.09965915	0.04950602
0.07059611	0.04180222
0.04591861	0.03374903
0.02595001	0.02551354
0.01103054	0.01731078
0.00210544	0.00892736
0 0];
%-0.00032332	0.00197526
B = [ 0 0 
0.00243856	-0.00475785
0.01228444	-0.01169926
0.02833961	-0.01672215
0.04924412	-0.02105495
0.07460431	-0.02493338
0.10411739	-0.02838685
0.13746245	-0.03147161
0.17430439	-0.03413898
0.21427868	-0.03632930
0.25699277	-0.03796257
0.30202762	-0.03894054
0.34893963	-0.03919715
0.39726219	-0.03845064
0.44649560	-0.03630690
0.49614685	-0.03303191
0.54574287	-0.02900235
0.59481754	-0.02449344
0.64291395	-0.01975164
0.68958696	-0.01500995
0.73440431	-0.01047738
0.77695104	-0.00635775
0.81682977	-0.00282910
0.85366263	-0.00003623
0.88709178	0.00194156
0.91678402	0.00309865
0.94243764	0.00347583
0.96378679	0.00317249
0.98060724	0.00233915
0.99272323	0.00120566
1.00000000	0.00000000];

xu = A(end:-1:1,1);
yu = A(end:-1:1,2);
xl = B(:,1);
yl = B(:,2);

C = [
-20.0	-0.560	0.24840	0.021	-26.257	0.175
-15.0	-0.563	0.11996	-0.007	-15.891	0.224
-10.0	-0.317	0.05983	-0.036	-7.806	0.310
-5.0	-0.189	0.02902	-0.066	-2.250	0.520
0.0	0.415	0.01088	-0.097	-0.639	0.752
5.0	0.975	0.02002	-0.109	-2.326	0.513
10.0	1.068	0.06314	-0.158	-5.535	0.362
15.0	1.086	0.13833	-0.187	-9.688	0.281
20.0	0.844	0.28256	-0.215	-15.386	0.227
25.0	0.574	0.43250	-0.241	-25.635	0.178
30.0	0.384	0.73830	-0.266	-37.870	0.147
35.0	0.264	1.09291	-0.288	-51.719	0.126
40.0	0.189	1.56300	-0.308	-66.762	0.111
45.0	0.141	2.12420	-0.325	-82.541	0.100
50.0	0.109	2.89580	-0.339	-98.577	0.091
55.0	0.088	1.33344	-0.351	-114.382	0.085
60.0	0.072	1.52123	-0.359	-129.477	0.080
65.0	0.061	1.78292	-0.364	-143.403	0.076
70.0	0.053	1.95407	-0.366	-155.737	0.073
75.0	0.047	2.24742	-0.366	-166.103	0.071
80.0	0.042	1.97688	-0.363	-174.188	0.069
85.0	0.038	2.22536	-0.357	-179.744	0.068
90.0	0.035	2.26070	-0.350	-182.605	0.068];

alpha = C(:,1);
CL = C(:,2);
CD = C(:,3);
CM = C(:,4);
end

function  [xu,yu,xl,yl,alpha,CL,CD,CM] = naca64415

A= [
1.00000000	0.00000000
0.99264326	0.00158696
0.98045509	0.00393147
0.96358653	0.00716831
0.94221973	0.01136937
0.91657001	0.01654245
0.88688831	0.02265717
0.85345602	0.02963421
0.81658426	0.03735718
0.77660368	0.04563780
0.73386217	0.05421603
0.68873097	0.06279599
0.64160742	0.07106549
0.59291603	0.07870996
0.54310501	0.08539900
0.49264704	0.09079157
0.44203978	0.09452074
0.39181009	0.09610369
0.34253487	0.09517388
0.29478149	0.09227143
0.24905947	0.08782965
0.20585847	0.08200814
0.16563461	0.07501891
0.12881447	0.06706703
0.09579589	0.05835215
0.06694817	0.04908148
0.04265502	0.03937861
0.02326222	0.02949421
0.00916163	0.01973097
0.00138761	0.01015386
 0 0];
%-0.00045672	0.00292137
B = [ 0 0
0.00165046	-0.00413751
0.00982396	-0.01308146
0.02508141	-0.02035573
0.04562471	-0.02662621
0.07080140	-0.03232380
0.10026251	-0.03742345
0.13364537	-0.04200816
0.17059770	-0.04601435
0.21074321	-0.04935414
0.25367906	-0.05191557
0.29897586	-0.05356250
0.34617721	-0.05419541
0.39480034	-0.05341788
0.44431453	-0.05072877
0.49420844	-0.04653460
0.54400713	-0.04132540
0.59324869	-0.03546147
0.64148418	-0.02926532
0.68827796	-0.02303534
0.73320774	-0.01704227
0.77586763	-0.01154178
0.81586831	-0.00676489
0.85283538	-0.00289062
0.88640926	-0.00001331
0.91625111	0.00185799
0.94205176	0.00276791
0.96353631	0.00282731
0.98047124	0.00220959
0.99267262	0.00117930
1.00000000	0.00000000];

C = [
-20.0	-0.768	0.18985	0.029	-19.918	0.200
-15.0	-0.642	0.10334	-0.001	-11.749	0.258
-10.0	-0.331	0.05633	-0.032	-5.453	0.364
-5.0	-0.143	0.01685	-0.078	-1.892	0.553
0.0	0.429	0.01409	-0.098	-0.765	0.722
5.0	0.962	0.02135	-0.115	-2.144	0.529
10.0	1.107	0.05876	-0.164	-5.311	0.368
15.0	1.292	0.11081	-0.195	-9.446	0.285
20.0	1.179	0.20571	-0.225	-14.423	0.233
25.0	0.919	0.36571	-0.253	-21.681	0.193
30.0	0.670	0.52869	-0.279	-31.755	0.160
35.0	0.485	0.98517	-0.302	-43.094	0.138
40.0	0.358	1.22847	-0.323	-55.353	0.121
45.0	0.272	1.81692	-0.340	-68.161	0.110
50.0	0.214	2.10880	-0.354	-81.129	0.101
55.0	0.173	2.76517	-0.365	-93.862	0.094
60.0	0.143	2.04414	-0.373	-105.973	0.088
65.0	0.122	1.94320	-0.377	-117.094	0.084
70.0	0.106	2.45732	-0.378	-126.888	0.080
75.0	0.094	2.59110	-0.376	-135.057	0.078
80.0	0.085	2.68264	-0.371	-141.352	0.077
85.0	0.078	2.48255	-0.363	-145.583	0.076
90.0	0.072	2.48215	-0.353	-147.621	0.075];

xu = A(end:-1:1,1);
yu = A(end:-1:1,2);
xl = B(:,1);
yl = B(:,2);

alpha = C(:,1);
CL = C(:,2);
CD = C(:,3);
CM = C(:,4);

end

function [xu,yu,xl,yl,alpha,CL,CD,CM] = naca64418

A= [
1.00000000	0.00000000
0.99258667	0.00162917
0.98031397	0.00409169
0.96334106	0.00755433
0.94185996	0.01212135
0.91609443	0.01782333
0.88630090	0.02463812
0.85276570	0.03249511
0.81580140	0.04127453
0.77573533	0.05077365
0.73290736	0.06070785
0.68767438	0.07073321
0.64041825	0.08048039
0.59155080	0.08957906
0.54150816	0.09762728
0.49075598	0.10420579
0.43979275	0.10886269
0.38915690	0.11099018
0.33946445	0.11005756
0.29133325	0.10670700
0.24529847	0.10150878
0.20187261	0.09466637
0.16152966	0.08643973
0.12471284	0.07707717
0.09183633	0.06682224
0.06328904	0.05592368
0.03949695	0.04453096
0.02080330	0.03302797
0.00761499	0.02184735
0.00086533	0.01139027
 0 0];
%-0.00060174	0.00398253
B = [ 0 0
0.00113975	-0.00324104
0.00779106	-0.01351883
0.02187473	-0.02303763
0.04185006	-0.03134055
0.06669331	-0.03901005
0.09601228	-0.04589896
0.12938210	-0.05211106
0.16642300	-0.05757347
0.20674210	-0.06216678
0.24992195	-0.06574610
0.29551893	-0.06813365
0.34305925	-0.06919080
0.39203792	-0.06839021
0.44188127	-0.06512204
0.49205396	-0.05995961
0.54208038	-0.05352618
0.59150467	-0.04626983
0.63988861	-0.03859066
0.68680999	-0.03086009
0.73185842	-0.02340472
0.77464086	-0.01654137
0.81477657	-0.01054500
0.85189395	-0.00561876
0.88563121	-0.00187179
0.91564288	0.00068350
0.94161053	0.00210286
0.96324925	0.00250548
0.98031482	0.00209010
0.99261407	0.00115600
1.00000000	0.00000000];

C = [
-20.0	-0.917	0.15238	0.038	-14.878	0.231
-15.0	-0.699	0.09140	0.007	-8.958	0.292
-10.0	-0.338	0.05541	-0.027	-4.652	0.389
-5.0	-0.019	0.02068	-0.066	-1.500	0.598
0.0	0.396	0.01559	-0.098	-0.897	0.693
5.0	0.860	0.02225	-0.126	-1.870	0.555
10.0	1.351	0.03920	-0.155	-4.878	0.382
15.0	1.396	0.09869	-0.203	-8.837	0.294
20.0	1.426	0.16824	-0.235	-13.626	0.240
25.0	1.237	0.26862	-0.265	-19.101	0.204
30.0	0.979	0.40495	-0.293	-25.832	0.177
35.0	0.748	0.61312	-0.318	-34.909	0.153
40.0	0.572	0.86430	-0.339	-44.688	0.135
45.0	0.446	1.15031	-0.357	-54.871	0.122
50.0	0.355	1.56099	-0.372	-65.150	0.113
55.0	0.290	1.98532	-0.382	-75.211	0.105
60.0	0.242	2.36167	-0.389	-84.749	0.099
65.0	0.207	17.53493	-0.392	-93.475	0.094
70.0	0.181	2.38152	-0.391	-101.122	0.090
75.0	0.161	3.33706	-0.387	-107.459	0.087
80.0	0.146	2.27789	-0.380	-112.294	0.086
85.0	0.134	2.45661	-0.370	-115.479	0.084
90.0	0.125	2.42907	-0.357	-116.917	0.084];

xu = A(end:-1:1,1);
yu = A(end:-1:1,2);
xl = B(:,1);
yl = B(:,2);
alpha = C(:,1);
CL = C(:,2);
CD = C(:,3);
CM = C(:,4);
end

function [xu,yu,xl,yl,alpha,CL,CD,CM] = naca64421

A = [
1.00000000	0.00000000
0.99252430	0.00167075
0.98015762	0.00424739
0.96306767	0.00792678
0.94145731	0.01284444
0.91556069	0.01905616
0.88564020	0.02654550
0.85198929	0.03525434
0.81492249	0.04505843
0.77476608	0.05574810
0.73185182	0.06701540
0.68652275	0.07847871
0.63914260	0.08971349
0.59010557	0.10028513
0.53983306	0.10972355
0.48878004	0.11752783
0.43744329	0.12315674
0.38637168	0.12586798
0.33622595	0.12493284
0.28768839	0.12109224
0.24132578	0.11507482
0.19767768	0.10713640
0.15723873	0.09759156
0.12047119	0.08673755
0.08780659	0.07487033
0.05965577	0.06228660
0.03648674	0.04918180
0.01859160	0.03613021
0.00634325	0.02370885
0.00045242	0.01260376
0 0];
%-0.00075236	0.00506466
B = [0 0
0.00078061	-0.00226885
0.00629937	-0.01335198
0.01899618	-0.02484076
0.03819430	-0.03517855
0.06252530	-0.04492782
0.09158001	-0.05374632
0.12486080	-0.06171659
0.16194698	-0.06876175
0.20242395	-0.07472498
0.24585489	-0.07942583
0.29177793	-0.08263818
0.33969660	-0.08417795
0.38907683	-0.08337085
0.43928772	-0.07949138
0.48976450	-0.07331691
0.54003232	-0.06561620
0.58964386	-0.05692993
0.63817636	-0.04774599
0.68522298	-0.03850090
0.73039026	-0.02958938
0.77329883	-0.02137892
0.81357767	-0.01418628
0.85085799	-0.00823897
0.88477357	-0.00364970
0.91497155	-0.00043501
0.94112280	0.00147360
0.96293145	0.00220272
0.98014126	0.00197905
0.99254885	0.00113526
1.00000000	0.00000000];

C = [
-20.0	-1.011	0.13652	0.049	-12.476	0.250
-15.0	-0.723	0.08937	0.015	-7.658	0.313
-10.0	-0.544	0.03347	-0.029	-3.803	0.423
-5.0	-0.195	0.02497	-0.061	-1.255	0.632
0.0	0.347	0.01790	-0.097	-1.038	0.667
5.0	0.813	0.02650	-0.131	-1.561	0.590
10.0	1.353	0.04347	-0.162	-4.347	0.401
15.0	1.476	0.09393	-0.211	-8.040	0.307
20.0	1.602	0.15188	-0.246	-12.528	0.250
25.0	1.501	0.23877	-0.279	-17.675	0.212
30.0	1.275	0.35766	-0.308	-23.325	0.186
35.0	1.028	0.50670	-0.335	-29.306	0.166
40.0	0.816	0.69111	-0.357	-36.747	0.149
45.0	0.651	0.91546	-0.376	-45.039	0.135
50.0	0.528	1.32685	-0.390	-53.388	0.124
55.0	0.436	1.55353	-0.401	-61.542	0.116
60.0	0.368	1.78676	-0.406	-69.253	0.109
65.0	0.317	2.24742	-0.408	-76.286	0.104
70.0	0.278	2.43513	-0.406	-82.428	0.100
75.0	0.249	2.76233	-0.400	-87.492	0.097
80.0	0.226	3.04400	-0.390	-91.324	0.095
85.0	0.209	2.93835	-0.377	-93.808	0.094
90.0	0.195	2.98902	-0.362	-94.869	0.093];

xu = A(end:-1:1,1);
yu = A(end:-1:1,2);
xl = B(:,1);
yl = B(:,2);
alpha = C(:,1);
CL = C(:,2);
CD = C(:,3);
CM = C(:,4);    
end

function [xu,yu,xl,yl,alpha,CL,CD,CM] = naca64425

A= [
1.00000000	0.00000000
0.99243281	0.00172551
0.97992705	0.00444938
0.96266262	0.00840682
0.94085791	0.01377270
0.91476312	0.02063719
0.88465066	0.02899404
0.85082505	0.03879984
0.81360491	0.04992580
0.77331939	0.06216371
0.73029121	0.07518194
0.68484054	0.08854092
0.63730636	0.10175464
0.58805547	0.11430788
0.53748651	0.12565129
0.48602853	0.13514810
0.43417246	0.14213353
0.38247951	0.14568221
0.33167762	0.14473427
0.28256056	0.14016217
0.23574789	0.13294107
0.19182212	0.12341102
0.15130881	0.11197420
0.11469814	0.09900456
0.08244296	0.08488562
0.05498509	0.06998771
0.03282818	0.05461690
0.01608377	0.03967617
0.00502136	0.02589172
0.00001644	0.01416482
0 0];
%-0.00095118	0.00648003
B = [ 0 0
0.00034602	-0.00099771
0.00498148	-0.01267889
0.01589406	-0.02614936
0.03382090	-0.03900568
0.05719275	-0.05155507
0.08565566	-0.06313642
0.11865939	-0.07364559
0.15570280	-0.08300518
0.19633646	-0.09099012
0.24008924	-0.09736859
0.28646935	-0.10183263
0.33494094	-0.10412333
0.38491859	-0.10334772
0.43566818	-0.09860647
0.48657737	-0.09101931
0.53717496	-0.08156409
0.58703021	-0.07091534
0.63575108	-0.05969734
0.68295624	-0.04843226
0.72827692	-0.03759212
0.77135483	-0.02760994
0.81183427	-0.01885929
0.84934799	-0.01158994
0.88352130	-0.00591396
0.91399019	-0.00185261
0.94040910	0.00067986
0.96246590	0.00182350
0.97988658	0.00184191
0.99245285	0.00111088
1.00000000	0.00000000];

C = [
-20.0	-1.103	0.12584	0.064	-9.885	0.279
-15.0	-0.764	0.08431	0.027	-5.887	0.352
-10.0	-0.522	0.03779	-0.020	-3.015	0.465
-5.0	-0.202	0.02961	-0.055	-1.048	0.665
0.0	0.280	0.02222	-0.097	-1.238	0.634
5.0	0.759	0.03249	-0.136	-1.697	0.574
10.0	1.199	0.04887	-0.181	-3.628	0.432
15.0	1.726	0.07487	-0.216	-6.918	0.328
20.0	1.767	0.13834	-0.262	-10.939	0.266
25.0	1.793	0.20732	-0.298	-15.567	0.226
30.0	1.638	0.30015	-0.330	-20.663	0.196
35.0	1.409	0.41881	-0.359	-26.071	0.176
40.0	1.173	0.54198	-0.383	-31.628	0.160
45.0	0.970	0.79615	-0.403	-37.163	0.148
50.0	0.806	0.98883	-0.417	-43.963	0.136
55.0	0.678	1.17330	-0.427	-50.613	0.127
60.0	0.580	1.33210	-0.432	-56.886	0.120
65.0	0.505	1.56247	-0.432	-62.591	0.115
70.0	0.447	1.94907	-0.427	-67.556	0.111
75.0	0.402	1.92510	-0.418	-71.630	0.108
80.0	0.367	2.01319	-0.405	-74.689	0.105
85.0	0.340	2.20717	-0.388	-76.639	0.104
90.0	0.318	2.37087	-0.369	-77.422	0.103];

xu = A(end: -1:1,1);
yu = A(end: -1:1,2);
xl = B(:,1);
yl = B(:,2);
alpha = C(:,1);
CL = C(:,2);
CD = C(:,3);
CM = C(:,4);   
end


